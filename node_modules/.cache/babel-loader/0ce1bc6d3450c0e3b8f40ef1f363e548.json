{"ast":null,"code":"class RHSFile {\n  constructor() {\n    this.dataView = null;\n    this.onProgress = this.onProgress.bind(this);\n    this.onLoad = this.onLoad.bind(this);\n    this.onError = this.onError.bind(this);\n  }\n\n  load(path) {\n    console.log(\"loading \" + path); //Test\n\n    var localPath = \"http://localhost:3001/sample/\" + path;\n    this.request = new XMLHttpRequest();\n    this.request.open(\"GET\", localPath, true);\n    this.request.responseType = \"arraybuffer\";\n    this.request.onprogress = this.onProgress;\n    this.request.onload = this.onLoad;\n    this.request.onerror = this.onError;\n    this.request.overrideMimeType(\"text/plain; charset=x-user-defined\");\n    this.request.send(null);\n  } //#####Events#####\n\n\n  onProgress(e) {\n    var percentage = e.loaded / e.total * 100;\n    console.log(e.loaded + ' / ' + e.total + \" (\" + percentage + '%)');\n  }\n\n  onLoad(e) {\n    if (this.request.readyState === 4) {\n      if (this.request.status === 200 || this.request.status === 0) {\n        this.dataView = new DataView(this.request.response);\n        console.log('file loaded successfully');\n      }\n    } else {\n      alert('Failed to read file');\n    } //Validate Magin-number\n\n\n    var magicNum = this.dataView.getMultiBytes(0, 4);\n\n    for (var i = 0; i < magicNum.length; i++) {\n      console.log('byte[' + i + '] : ' + magicNum[i].toString(16));\n    }\n\n    console.log('version: ' + this.dataView.getInt16(4));\n    console.log('sample rate: ' + this.dataView.getFloat32(8));\n    console.log('DSP Enabled: ' + this.dataView.getInt16(12));\n  }\n\n  onError(e) {\n    console.log('Error : ' + this.request.statusText);\n  } //#####Utilities#####\n\n\n  getByte(index) {\n    if (this.filestream) return this.filestream.charCodeAt(index) & 0xff;else return 0x00;\n  } //little-endian\n\n\n  getMultiBytes(startIdx, count) {\n    var array = [];\n\n    for (var i = count - 1; i > -1; i--) {\n      array.push(this.dataView.getUint8(startIdx + i));\n    }\n\n    return array;\n  }\n\n  getInt16(index) {\n    var bytes = this.getMultiBytes(index, 2);\n    var value = 0;\n\n    for (var i = 0; i < bytes.length; i++) {\n      value = value << i * 8 | bytes[i];\n    }\n\n    return value;\n  }\n\n  getSingle(index) {\n    var bytes = this.getMultiBytes(index, 4);\n    var value = 0;\n    var f = new Float32Array(1);\n\n    for (var i = 0; i < bytes.length; i++) {\n      value = value << i * 8 | bytes[i];\n    }\n\n    f[0] = f[0] | value;\n    return f[0];\n  }\n\n}\n\nexport default RHSFile;","map":{"version":3,"sources":["C:/Users/tank6/Desktop/React/brainwave_webviewer/src/pages/RHSFile.js"],"names":["RHSFile","constructor","dataView","onProgress","bind","onLoad","onError","load","path","console","log","localPath","request","XMLHttpRequest","open","responseType","onprogress","onload","onerror","overrideMimeType","send","e","percentage","loaded","total","readyState","status","DataView","response","alert","magicNum","getMultiBytes","i","length","toString","getInt16","getFloat32","statusText","getByte","index","filestream","charCodeAt","startIdx","count","array","push","getUint8","bytes","value","getSingle","f","Float32Array"],"mappings":"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","sourcesContent":["class RHSFile{\r\n    constructor(){\r\n        this.dataView = null;\r\n        this.onProgress = this.onProgress.bind(this);\r\n        this.onLoad = this.onLoad.bind(this);\r\n        this.onError = this.onError.bind(this);\r\n    }\r\n\r\n    load (path){\r\n        console.log(\"loading \" + path);\r\n\r\n        //Test\r\n        var localPath = \"http://localhost:3001/sample/\" + path;\r\n\r\n        this.request = new XMLHttpRequest();\r\n        this.request.open(\"GET\", localPath, true);\r\n        this.request.responseType = \"arraybuffer\";\r\n        this.request.onprogress = this.onProgress;\r\n        this.request.onload = this.onLoad;\r\n        this.request.onerror = this.onError;\r\n        this.request.overrideMimeType(\"text/plain; charset=x-user-defined\");\r\n        this.request.send(null);\r\n    }\r\n\r\n    //#####Events#####\r\n    onProgress(e){\r\n        var percentage = e.loaded / e.total * 100;\r\n        console.log(e.loaded + ' / ' + e.total + \" (\" + percentage + '%)');\r\n    }\r\n\r\n    onLoad (e){\r\n        if(this.request.readyState === 4) {\r\n            if(this.request.status === 200 || this.request.status === 0) {\r\n                this.dataView = new DataView(this.request.response);\r\n                console.log('file loaded successfully');\r\n            }\r\n        }\r\n        else{\r\n            alert('Failed to read file');\r\n        }\r\n\r\n        //Validate Magin-number\r\n        var magicNum = this.dataView.getMultiBytes(0, 4);\r\n        for (var i = 0; i < magicNum.length; i++){\r\n            console.log('byte[' + i + '] : ' + magicNum[i].toString(16));\r\n        }\r\n\r\n        console.log('version: ' + this.dataView.getInt16(4));\r\n        console.log('sample rate: ' + this.dataView.getFloat32(8));\r\n        console.log('DSP Enabled: ' + this.dataView.getInt16(12));\r\n    }\r\n\r\n    onError (e){\r\n        console.log('Error : ' + this.request.statusText);\r\n    }\r\n    \r\n    //#####Utilities#####\r\n    getByte (index) {\r\n        if (this.filestream)\r\n            return this.filestream.charCodeAt(index) & 0xff;\r\n        else\r\n            return 0x00;\r\n    }\r\n\r\n    //little-endian\r\n    getMultiBytes(startIdx, count) {\r\n        var array = [];\r\n        for(var i = count - 1; i > -1; i--){\r\n            array.push(this.dataView.getUint8(startIdx + i));\r\n        }\r\n        \r\n        return array;\r\n    }\r\n\r\n    getInt16(index) {\r\n        var bytes = this.getMultiBytes(index, 2);\r\n        var value = 0;\r\n\r\n        for (var i = 0; i < bytes.length; i++){\r\n            value = (value << (i * 8)) | bytes[i];\r\n        }\r\n\r\n        return value;\r\n    }\r\n\r\n    getSingle(index) {\r\n        var bytes = this.getMultiBytes(index, 4);\r\n        var value = 0;\r\n        var f = new Float32Array(1);\r\n\r\n        for (var i = 0; i < bytes.length; i++){\r\n            value = (value << (i * 8)) | bytes[i];\r\n        }\r\n\r\n        f[0] = f[0] | value;\r\n\r\n        return f[0];\r\n    }\r\n}\r\n\r\nexport default RHSFile;"]},"metadata":{},"sourceType":"module"}